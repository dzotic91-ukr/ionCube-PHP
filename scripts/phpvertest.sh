#!/bin/bash
a=`php -v |head -n1 |awk '{print $2}'|cut -f 1,2 -d .`;

grep -q ioncube_loader_lin_ /etc/php.ini || sed -i '$ a\[ioncube\]\n;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_5.3.so\n\;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_5.3_ts.so\n\;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_5.4.so\n\;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_5.4_ts.so\n\;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_5.5.so\n\;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_5.5_ts.so\n\;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_5.6.so\n\;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_5.6_ts.so\n\;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_7.0.so\n\;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_7.0_ts.so\n\;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_7.1.so\n\;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_7.1_ts.so\n\;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_7.2.so\n\;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_7.2_ts.so\n\;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_7.3.so\n\;zend_extension=/usr/lib64/php/modules/ioncube/ioncube_loader_lin_7.3_ts.so\n\;' /etc/php.ini ;

ioncube_loader_line=$(echo $(grep $a'.so' /etc/php.ini) | sed 's/^.//');
sed -i "s|;$ioncube_loader_line|$ioncube_loader_line|g" /etc/php.ini
